# Thali installer

## About iOS Install for Developers

Thali is intended to be installer via npm.

There're several steps that Thali installer does. We're not going to cover
all the steps, but to cover the most complicated steps.

Let's begin from what _thali/install/install.js_ script does. This's the main
installer script.

The command `cordova plugins add` is executed as the final step of _install.js_.
It triggers the following Cordova hooks:
1. _cordova-hooks/ios/before_plugin_install.js_
  - updates import of Swift code in Objective-C code, i.e. JXcoreExtension.m.
  Most of our code is written on Swift, but we have to use Objective-C to
  integrate with JXcore Cordova. So import Swift code into Objective-C is required.
  There's a standard approach doing it, i.e. import current module with '-Swift' postfix.
  We should update import as soon as we know the name of the final Xcode project.
2. _cordova-hooks/ios/after_plugin_install.js_
  - downloads and builds ThaliCore with its dependencies using `carthage`
  - integrates ThaliCore and its dependencies into Xcode project. This logic is
  implemented in _thali/install/ios/nativeInstaller.js_

Note that iOS native code is in separate [repo](https://github.com/thaliproject/thali-ios).

## About iOS Testing for Developers

- ThaliTest Cordova app is generated by _build.sh_ to run tests on CI. It builds
__ThaliCore__ and __ThaliCoreCITests__ (only for testing) frameworks.
- ThaliCoreCITests uses open source version of [XCTest](https://github.com/apple/swift-corelibs-xctest)
framework.
- We're using our own [fork](https://github.com/thaliproject/swift-corelibs-xctest).
The current origin version supports only macOS, we need iOS. So we have PR,
that hopefully will be accepted soon.
- There're still some work TODO.
